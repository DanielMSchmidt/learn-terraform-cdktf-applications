# Develop applications with CDKTF

Note: Still very much WIP/rough notes, not ready to run yet.

1. Create cluster

    ```sh
    kind create cluster --name=cdktf-app
    ```

1. Install CDKTF libraries, CLI, and constructs (peer dependency)

    ```sh
    npm install -g cdktf-cli@latest cdktf@latest constructs@^10.0.0
    ```

1. Go into the app directory.

    ```sh
    cd app
    ```

1. Initialize CDKTF app (starting from empty directory).

    ```sh
    cdktf init --template=typescript --project-name=learn-terraform-cdktf-applications --project-description="Learn how to develop CDKTF applications" --local
    ```

1. Install docker provider.

    ```sh
    npm install @cdktf/provider-kubernetes
    ```

1. Add provider to `cdktf.json`:

    ```json
    {
      "language": "typescript",
      "app": "npm run --silent compile && node main.js",
      "projectId": "9e131c9e-f878-4dde-84dd-88218e539bea",
      "terraformProviders": ["hashicorp/kubernetes ~> 2.5.0"],
      "terraformModules": [],
      "context": {
        "excludeStackIdFromLogicalIds": "true",
    "allowSepCharsInLogicalIds": "true"
      }
    }
    ```

1. Run cdktf get

    ```sh
    cdktf get
    ```

1. Synth

    ```sh
    cdktf synth
    ```

1. Deploy

    ```sh
    cdktf deploy
    ```


<!-- Skip, or find a k8s example that works cleanly

1. Use CDKTF to convert from example in `docker_image.tf` from the [provider docs](https://registry.terraform.io/providers/kreuzwerker/docker/latest/docs/resources/image#build).

```
$ cat docker_image.tf | cdktf convert
/*Provider bindings are generated by running cdktf get.
See https://github.com/hashicorp/terraform-cdk/blob/main/docs/working-with-cdk-for-terraform/using-providers.md#importing-providers-and-modules for more details.*/
import * as docker from "./.gen/providers/docker";
new docker.Image(this, "zoo", {
  build: [
    {
      buildArg: [
        {
          foo: "zoo",
        },
      ],
      label: [
        {
          author: "zoo",
        },
      ],
      path: ".",
      tag: ["zoo:develop"],
    },
  ],
  name: "zoo",
});
``` -->

